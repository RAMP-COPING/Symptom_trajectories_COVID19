}
if(!require(glue)){
install.packages("glue")
library(glue)
}
if(!require(MplusAutomation)){
install.packages("MplusAutomation")
library(MplusAutomation)
}
if(!require(texreg)){
install.packages("texreg")
library(texreg)
}
if(!require(relimp)){
install.packages("relimp")
library(relimp)
}
if(!require(BiocManager)){
install.packages("BiocManager")
library(BiocManager)
}
if(!require(rhdf5)){
BiocManager::install("rhdf5")
library(rhdf5)
}
if(!require(plyr)){
install.packages("plyr")
library(plyr)
}
if(!require(tidyverse)){
install.packages("tidyverse")
library(tidyverse)
}
if(!require(kableExtra)){
install.packages("kableExtra")
library(kableExtra)
}
if(!require(lmtest)){
install.packages("lmtest")
library(lmtest)
}
## global workbook settings
knitr::opts_chunk$set(results = 'asis',
comment = NA,
prompt = FALSE,
cache = FALSE,
warning = FALSE,
echo = TRUE,
fig.height = 5,
fig.width = 10,
fig.align = "center")
#st_options(plain.ascii = FALSE,
#            style = "rmarkdown",
#            footnote = NA,
#            subtitle.emphasis = FALSE)
options(scipen = 999)
pres.palette <- c("#4ED1B7", "#F6C66A", "#3066BE", "#D90368","#1B2D2A",  "#4C2E05","#C98686")
timepoint_list <- c("7 Apr '20","19 May '20","2 Jun '20","16 Jun '20","30 Jun '20",
"14 Jul '20", "28 Jul '20","25 Aug '20","22 Sep '20","20 Oct '20",
"17 Nov '20","15 Dec '20","12 Jan '21","9 Feb '21",
"9 Mar '21", "6 Apr '21")
timepoint_list_anh <- c("7 Apr '20", "19 May '20","2 Jun '20","16 Jun '20","30 Jun '20",
"14 Jul '20", "28 Jul '20","25 Aug '20","22 Sep '20","20 Oct '20",
"17 Nov '20","15 Dec '20","12 Jan '21","9 Feb '21",
"9 Mar '21", "6 Apr '21")
anhedonia.one.class.out <- readModels("./MPlus_input_lgcm/MASQ/masq_latentGrowthCurve_piecewise_wPairwise_correlations.out",
recursive=FALSE)
anhedonia.two.class.out <- readModels("./MPlus_input_gmm/MASQ/masq_GMM_piecewise_2_classes.out",
recursive=FALSE)
justBIC_one_class <- anhedonia.one.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
justBIC_two_class <- anhedonia.two.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_one_two_compare <- rbind(justBIC_one_class,
justBIC_two_class)
BIC_one_two_compare
BIC_one_two_compare$BIC[1] - BIC_one_two_compare$BIC[2]
BIC_one_two_compare$aBIC[1] - BIC_one_two_compare$aBIC[2]
anhedonia.three.class.out <- readModels("./MPlus_input_gmm/MASQ/masq_GMM_piecewise_3_classes.out",
recursive=FALSE)
justBIC_three_class <- anhedonia.three.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_two_three_compare <- rbind(justBIC_two_class,
justBIC_three_class)
BIC_two_three_compare
BIC_two_three_compare$BIC[1] - BIC_two_three_compare$BIC[2]
BIC_two_three_compare$aBIC[1] - BIC_two_three_compare$aBIC[2]
anhedonia.four.class.out <- readModels("./MPlus_input_gmm/MASQ/masq_GMM_piecewise_4_classes.out",
recursive=FALSE)
justBIC_four_class <- anhedonia.four.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_three_four_compare <- rbind(justBIC_three_class,
justBIC_four_class)
BIC_three_four_compare
BIC_three_four_compare$BIC[1] - BIC_three_four_compare$BIC[2]
BIC_three_four_compare$aBIC[1] - BIC_three_four_compare$aBIC[2]
anhedonia.five.class.out <- readModels("./MPlus_input_gmm/MASQ/masq_GMM_piecewise_5_classes.out",
recursive=FALSE,
what=c("summaries","gh5"))
justBIC_five_class <- anhedonia.five.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_four_five_compare <- rbind(justBIC_four_class,
justBIC_five_class)
BIC_four_five_compare
BIC_four_five_compare$BIC[1] - BIC_four_five_compare$BIC[2]
BIC_four_five_compare$aBIC[1] - BIC_four_five_compare$aBIC[2]
anhedonia.six.class.out <- readModels("./MPlus_input_gmm/MASQ/masq_GMM_piecewise_6_classes.out",
recursive=FALSE)
justBIC_six_class <- anhedonia.six.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_five_six_compare <- rbind(justBIC_five_class,
justBIC_six_class)
BIC_five_six_compare
BIC_five_six_compare$BIC[1] - BIC_five_six_compare$BIC[2]
BIC_five_six_compare$aBIC[1] - BIC_five_six_compare$aBIC[2]
anhedonia.seven.class.out <- readModels("./MPlus_input_gmm/MASQ/masq_GMM_piecewise_7_classes.out",
recursive=FALSE)
justBIC_seven_class <- anhedonia.seven.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_six_seven_compare <- rbind(justBIC_six_class,
justBIC_seven_class)
BIC_six_seven_compare
BIC_six_seven_compare$BIC[1] - BIC_six_seven_compare$BIC[2]
BIC_six_seven_compare$aBIC[1] - BIC_six_seven_compare$aBIC[2]
anhedonia.all.out <- readModels("./MPlus_input_gmm/MASQ/output",
recursive=FALSE,
what = c("summaries","class_counts"))
justSummariesGMM <- do.call("rbind.fill",
sapply(anhedonia.all.out ,"[", "summaries")) %>%
select(c("Title", "Parameters",  "Entropy", "AIC", "BIC","aBIC", "LL")) %>%
arrange(BIC)
justSummarieslgcm <- anhedonia.one.class.out$summaries %>%
select(c("Title", "Parameters", "AIC", "BIC","aBIC", "LL")) %>%
arrange(BIC)
justSummarieslgcm$Entropy <- "1"
justSummarieslgcm <- justSummarieslgcm %>%
relocate(Entropy, .after=Parameters)
justSummaries <- rbind(justSummariesGMM,justSummarieslgcm) %>%
arrange(BIC)
summary_table <- justSummaries %>%
kbl(caption ="Growth mixture modelling fit statistics for all models tested: MASQ",
align='lcccccc') %>%
kable_styling()
summary_table
class_allocation_2 <- anhedonia.all.out$masq_GMM_piecewise_2_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Two class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(anhedonia.all.out$masq_GMM_piecewise_2_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_2
class_allocation_3 <-anhedonia.all.out$masq_GMM_piecewise_3_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Three class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(anhedonia.all.out$masq_GMM_piecewise_3_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_3
class_allocation_4 <- anhedonia.all.out$masq_GMM_piecewise_4_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Four class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(anhedonia.all.out$masq_GMM_piecewise_4_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_4
class_allocation_5 <- anhedonia.all.out$masq_GMM_piecewise_5_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Five class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(anhedonia.all.out$masq_GMM_piecewise_5_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_5
class_allocation_6 <-anhedonia.all.out$masq_GMM_piecewise_6_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Six class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(anhedonia.all.out$masq_GMM_piecewise_6_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_6
class_allocation_7 <-anhedonia.all.out$masq_GMM_piecewise_7_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Seven class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(anhedonia.all.out$masq_GMM_piecewise_7_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_7
# reorder the title column by BIC for plotting
justSummaries$Title <-  reorder(justSummaries$Title, -justSummaries$BIC)
BIC_scree_plot <- ggplot() +
geom_line(data =justSummaries,
aes(x = Title, y = BIC,group=1)) +
scale_x_discrete(name="Growth mixture model type",labels=c("One class","Two class","Three class","Four class","Five class","Six class","Seven class")) +
geom_point(data = justSummaries,
aes(x = Title, y = BIC,group=1), show.legend = F) +
labs(title="Scree plot showing decreasing Bayesian Information Criterion (BIC) values for each K+1 growth mixture model",
subtitle="Anhedonia (MASQ-AD)",
y ="BIC") +
theme(panel.background = element_blank(),
axis.text.x = element_text(angle = 0), axis.text = element_text(size = 15), axis.title=element_text(size=16,face="bold"))
BIC_scree_plot
#create scree plot without 1-class model
BIC_scree_plot2 <- ggplot() +
geom_line(data =justSummaries[1:6,],
aes(x = Title, y = BIC,group=1)) +
scale_x_discrete(name="Growth mixture model type",labels=c("Two class","Three class","Four class","Five class","Six class","Seven class")) +
geom_point(data = justSummaries[1:6,],
aes(x = Title, y = BIC,group=1), show.legend = F) +
labs(title="Scree plot showing decreasing Bayesian Information Criterion (BIC) values for each K+1 growth mixture model",
subtitle="Anhedonia (MASQ-AD)",
y ="BIC") +
theme(panel.background = element_blank(),
axis.text.x = element_text(angle = 0), axis.text = element_text(size = 10), axis.title=element_text(size=12,face="bold"), plot.title = element_text(size=10))
BIC_scree_plot2
save_file_path <- file.path(dirname(dirname(getwd())),"output/supplementary_tables_figures/MASQ/")
ggsave(
filename=file.path(save_file_path,"masq_BIC_scree_plot-start-at-two.png"), width = 8, height = 4, dpi = 120, units = "in", device='png',
plot =BIC_scree_plot2)
# clear global environment
remove(list = ls())
# Install / load packages
if(!require(knitr)){
install.packages("knitr")
library(knitr)
}
#if(!require(summarytools)){
#  install.packages("summarytools")
#  library(summarytools)
#}
if(!require(data.table)){
install.packages("data.table")
library(data.table)
}
if(!require(kableExtra)){
install.packages("kableExtra")
library(kableExtra)
}
if(!require(glue)){
install.packages("glue")
library(glue)
}
if(!require(MplusAutomation)){
install.packages("MplusAutomation")
library(MplusAutomation)
}
if(!require(texreg)){
install.packages("texreg")
library(texreg)
}
if(!require(relimp)){
install.packages("relimp")
library(relimp)
}
if(!require(BiocManager)){
install.packages("BiocManager")
library(BiocManager)
}
if(!require(rhdf5)){
BiocManager::install("rhdf5")
library(rhdf5)
}
if(!require(plyr)){
install.packages("plyr")
library(plyr)
}
if(!require(tidyverse)){
install.packages("tidyverse")
library(tidyverse)
}
if(!require(kableExtra)){
install.packages("kableExtra")
library(kableExtra)
}
if(!require(lmtest)){
install.packages("lmtest")
library(lmtest)
}
## global workbook settings
knitr::opts_chunk$set(results = 'asis',
comment = NA,
prompt = FALSE,
cache = FALSE,
warning = FALSE,
echo = TRUE,
fig.height = 5,
fig.width = 10,
fig.align = "center")
#st_options(plain.ascii = FALSE,
#            style = "rmarkdown",
#            subtitle.emphasis = FALSE)
##            footnote = NA,
options(scipen = 999)
pres.palette <- c("#4ED1B7", "#F6C66A", "#3066BE", "#D90368","#1B2D2A",  "#4C2E05","#C98686")
timepoint_list <- c("7 Apr '20","19 May '20","2 Jun '20","16 Jun '20","30 Jun '20",
"14 Jul '20", "28 Jul '20","25 Aug '20","22 Sep '20","20 Oct '20",
"17 Nov '20","15 Dec '20","12 Jan '21","9 Feb '21",
"9 Mar '21", "6 Apr '21")
timepoint_list_anh <- c("19 May '20","2 Jun '20","16 Jun '20","30 Jun '20",
"14 Jul '20", "28 Jul '20","25 Aug '20","22 Sep '20","20 Oct '20",
"17 Nov '20","15 Dec '20","12 Jan '21","9 Feb '21",
"9 Mar '21", "6 Apr '21")
depression.one.class.out <- readModels("./MPlus_input_lgcm/PHQ/phq_latentGrowthCurve_piecewise_wPairwise_correlations.out",
recursive=FALSE)
depression.two.class.out <- readModels("./MPlus_input_gmm/PHQ/phq_GMM_piecewise_2_classes.out",
recursive=FALSE)
justBIC_one_class <- depression.one.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
justBIC_two_class <- depression.two.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_one_two_compare <- rbind(justBIC_one_class,
justBIC_two_class)
BIC_one_two_compare
BIC_one_two_compare$BIC[1] - BIC_one_two_compare$BIC[2]
BIC_one_two_compare$aBIC[1] - BIC_one_two_compare$aBIC[2]
depression.three.class.out <- readModels("./MPlus_input_gmm/PHQ/phq_GMM_piecewise_3_classes.out",
recursive=FALSE)
justBIC_three_class <- depression.three.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_two_three_compare <- rbind(justBIC_two_class,
justBIC_three_class)
BIC_two_three_compare
BIC_two_three_compare$BIC[1] - BIC_two_three_compare$BIC[2]
BIC_two_three_compare$aBIC[1] - BIC_two_three_compare$aBIC[2]
depression.four.class.out <- readModels("./MPlus_input_gmm/PHQ/phq_GMM_piecewise_4_classes.out",
recursive=FALSE)
justBIC_four_class <- depression.four.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_three_four_compare <- rbind(justBIC_three_class,
justBIC_four_class)
BIC_three_four_compare
BIC_three_four_compare$BIC[1] - BIC_three_four_compare$BIC[2]
BIC_three_four_compare$aBIC[1] - BIC_three_four_compare$aBIC[2]
depression.five.class.out <- readModels("./MPlus_input_gmm/PHQ/phq_GMM_piecewise_5_classes.out",
recursive=FALSE)
justBIC_five_class <- depression.five.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_four_five_compare <- rbind(justBIC_four_class,
justBIC_five_class)
BIC_four_five_compare
BIC_four_five_compare$BIC[1] - BIC_four_five_compare$BIC[2]
BIC_four_five_compare$aBIC[1] - BIC_four_five_compare$aBIC[2]
depression.six.class.out <- readModels("./MPlus_input_gmm/PHQ/phq_GMM_piecewise_6_classes.out",
recursive=FALSE)
justBIC_six_class <- depression.six.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_five_six_compare <- rbind(justBIC_five_class,
justBIC_six_class)
BIC_five_six_compare
BIC_five_six_compare$BIC[1] - BIC_five_six_compare$BIC[2]
BIC_five_six_compare$aBIC[1] - BIC_five_six_compare$aBIC[2]
depression.seven.class.out <- readModels("./MPlus_input_gmm/PHQ/phq_GMM_piecewise_7_classes.out",
recursive=FALSE)
justBIC_seven_class <- depression.seven.class.out$summaries  %>%
select(c("Title",  "BIC", "aBIC")) %>%
arrange(BIC)
BIC_six_seven_compare <- rbind(justBIC_six_class,
justBIC_seven_class)
BIC_six_seven_compare
BIC_six_seven_compare$BIC[1] - BIC_six_seven_compare$BIC[2]
BIC_six_seven_compare$aBIC[1] - BIC_six_seven_compare$aBIC[2]
depression.all.out <- readModels("./MPlus_input_gmm/PHQ/output",
recursive=FALSE)
justSummariesGMM <- do.call("rbind.fill",
sapply(depression.all.out ,"[", "summaries")) %>%
select(c("Title", "Parameters",  "Entropy", "AIC", "BIC","aBIC", "LL")) %>%
arrange(BIC)
justSummarieslgcm <- depression.one.class.out$summaries %>%
select(c("Title", "Parameters", "AIC", "BIC","aBIC", "LL")) %>%
arrange(BIC)
justSummarieslgcm$Entropy <- "1"
justSummarieslgcm <- justSummarieslgcm %>%
relocate(Entropy, .after=Parameters)
justSummaries <- rbind(justSummariesGMM,justSummarieslgcm) %>%
arrange(BIC)
summary_table <- justSummaries %>%
kbl(caption ="Growth mixture modelling fit statistics for all models tested: PHQ",
align='lcccccc') %>%
kable_styling()
summary_table
class_allocation_2 <- depression.all.out$phq_GMM_piecewise_2_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Two class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(depression.all.out$phq_GMM_piecewise_2_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_2
class_allocation_3 <- depression.all.out$phq_GMM_piecewise_3_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Three class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(depression.all.out$phq_GMM_piecewise_3_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_3
class_allocation_4 <- depression.all.out$phq_GMM_piecewise_4_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Four class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(depression.all.out$phq_GMM_piecewise_4_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_4
class_allocation_5 <- depression.all.out$phq_GMM_piecewise_5_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Five class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(depression.all.out$phq_GMM_piecewise_5_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_5
class_allocation_6 <- depression.all.out$phq_GMM_piecewise_6_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Six class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(depression.all.out$phq_GMM_piecewise_6_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_6
class_allocation_7 <- depression.all.out$phq_GMM_piecewise_7_classes.out$class_counts$mostLikely %>%
kbl(caption = "Counts and proportions of most likely class membership: Seven class solution",
align='lll',
digits = 2,
col.names = str_to_title(gsub("[.]", " ", names(depression.all.out$phq_GMM_piecewise_7_classes.out$class_counts$mostLikely)))) %>%
kable_styling(position = "left",
"striped")
class_allocation_7
# reorder the title column by BIC for plotting
justSummaries$Title <-  reorder(justSummaries$Title, -justSummaries$BIC)
BIC_scree_plot <- ggplot() +
geom_line(data =justSummaries,
aes(x = Title, y = BIC,group=1)) +
scale_y_continuous(limits =c(1745000,1772500), breaks = seq(1745000,1772500,by=5000)) +
scale_x_discrete(name="Growth mixture model type",labels=c("One class","Two class","Three class","Four class","Five class","Six class","Seven class")) +
geom_point(data = justSummaries,
aes(x = Title, y = BIC,group=1), show.legend = F) +
labs(title="Scree plot showing decreasing Bayesian Information Criterion (BIC) values for each K+1 growth mixture model",
subtitle="Depression symptoms (PHQ-9)",
y ="BIC") +
theme(panel.background = element_blank(),
axis.text.x = element_text(angle = 0), axis.text = element_text(size = 10), axis.title=element_text(size=12,face="bold"))
BIC_scree_plot
#create scree plot without 1-class model
BIC_scree_plot2 <- ggplot() +
geom_line(data =justSummaries[1:6,],
aes(x = Title, y = BIC,group=1)) +
scale_y_continuous(limits =c(1745000,1772500), breaks = seq(1745000,1772500,by=5000)) +
scale_x_discrete(name="Growth mixture model type",labels=c("Two class","Three class","Four class","Five class","Six class","Seven class")) +
geom_point(data = justSummaries[1:6,],
aes(x = Title, y = BIC,group=1), show.legend = F) +
labs(title="Scree plot showing decreasing Bayesian Information Criterion (BIC) values for each K+1 growth mixture model",
subtitle="Depression symptoms (PHQ-9)",
y ="BIC") +
xlab("Growth mixture model type") +
theme(panel.background = element_blank(),
axis.text.x = element_text(angle = 0), axis.text = element_text(size = 15), axis.title=element_text(size=16,face="bold"), plot.title = element_text(size=10))
BIC_scree_plot2
save_file_path <- file.path(dirname(dirname(getwd())),"output/supplementary_tables_figures/PHQ/")
ggsave(
filename=file.path(save_file_path,"phq_BIC_scree_plot-start-at-two.png"),width = 8, height = 4, dpi = 120, units = "in", device='png',
plot =BIC_scree_plot2)
# reorder the title column by BIC for plotting
justSummaries$Title <-  reorder(justSummaries$Title, -justSummaries$BIC)
BIC_scree_plot <- ggplot() +
geom_line(data =justSummaries,
aes(x = Title, y = BIC,group=1)) +
scale_y_continuous(limits =c(1745000,1772500), breaks = seq(1745000,1772500,by=5000)) +
scale_x_discrete(name="Growth mixture model type",labels=c("One class","Two class","Three class","Four class","Five class","Six class","Seven class")) +
geom_point(data = justSummaries,
aes(x = Title, y = BIC,group=1), show.legend = F) +
labs(title="Scree plot showing decreasing Bayesian Information Criterion (BIC) values for each K+1 growth mixture model",
subtitle="Depression symptoms (PHQ-9)",
y ="BIC") +
theme(panel.background = element_blank(),
axis.text.x = element_text(angle = 0), axis.text = element_text(size = 10), axis.title=element_text(size=12,face="bold"))
BIC_scree_plot
#create scree plot without 1-class model
BIC_scree_plot2 <- ggplot() +
geom_line(data =justSummaries[1:6,],
aes(x = Title, y = BIC,group=1)) +
scale_y_continuous(limits =c(1745000,1772500), breaks = seq(1745000,1772500,by=5000)) +
scale_x_discrete(name="Growth mixture model type",labels=c("Two class","Three class","Four class","Five class","Six class","Seven class")) +
geom_point(data = justSummaries[1:6,],
aes(x = Title, y = BIC,group=1), show.legend = F) +
labs(title="Scree plot showing decreasing Bayesian Information Criterion (BIC) values for each K+1 growth mixture model",
subtitle="Depression symptoms (PHQ-9)",
y ="BIC") +
xlab("Growth mixture model type") +
theme(panel.background = element_blank(),
axis.text.x = element_text(angle = 0), axis.text = element_text(size = 10), axis.title=element_text(size=12,face="bold"), plot.title = element_text(size=10))
BIC_scree_plot2
ggsave(
filename=file.path(save_file_path,"phq_BIC_scree_plot-start-at-two.png"),width = 8, height = 4, dpi = 120, units = "in", device='png',
plot =BIC_scree_plot2)
